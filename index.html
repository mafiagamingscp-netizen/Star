<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stars Store | Mohamed Elsayed</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCU9BHs2_OPXgGEtrMsdfnSQu6DWW2hizc",
            authDomain: "star-a1919.firebaseapp.com",
            databaseURL: "https://star-a1919-default-rtdb.firebaseio.com",
            projectId: "star-a1919",
            storageBucket: "star-a1919.firebasestorage.app",
            messagingSenderId: "701396590814",
            appId: "1:701396590814:web:8f3a1f6c5eea8b23b7224f"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const BOT_TOKEN = "7832899435:AAHHLNw1EhuaXoBezB78UfyVAzSK4yOPayM";
        const ADMIN_ID = "7549050561"; 

        window.sendAction = async (type, data) => {
            let message = type === 'buy' 
                ? `ğŸ“¥ *Ø·Ù„Ø¨ Ø´Ø±Ø§Ø¡ Ø¬Ø¯ÙŠØ¯*\nâ”â”â”â”â”â”â”â”â”â”â”â”\nğŸ‘¤ Ø§Ù„Ø¹Ù…ÙŠÙ„: ${data.user}\nğŸ’ Ù†Ø¬ÙˆÙ…: ${data.stars}\nğŸ’° Ø§Ù„Ø³Ø¹Ø±: ${data.price} EGP\nğŸ’³ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©: ${data.method}`
                : `ğŸ“¤ *Ø·Ù„Ø¨ Ø¨ÙŠØ¹ Ø¬Ø¯ÙŠØ¯*\nâ”â”â”â”â”â”â”â”â”â”â”â”\nğŸ‘¤ Ø§Ù„Ø¹Ù…ÙŠÙ„: ${data.user}\nğŸ’ Ù†Ø¬ÙˆÙ…: ${data.stars}\nğŸ’µ Ø³ÙŠØ³ØªÙ„Ù…: ${data.price} EGP\nğŸ“± Ø§Ù„Ø±Ù‚Ù…: ${data.receiveNumber}\nğŸ’³ Ø§Ù„ÙˆØ³ÙŠÙ„Ø©: ${data.method}`;

            try {
                // 1. Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¨ÙˆØª (ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ø£Ø¯Ù…Ù† Ø¹Ù…Ù„ Start Ù„Ù„Ø¨ÙˆØª)
                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: ADMIN_ID,
                        text: message,
                        parse_mode: 'Markdown'
                    })
                });

                // 2. Ø­ÙØ¸ ÙÙŠ Firebase
                await push(ref(db, type + '_orders'), { ...data, timestamp: Date.now() });

                if(type === 'buy') {
                    alert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø±Ø§Ø¡ Ø¨Ù†Ø¬Ø§Ø­ Ù„Ù„Ø£Ø¯Ù…Ù†.");
                } else {
                    // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„ØµØ­ÙŠØ­ Ù„ØªØ¬Ù†Ø¨ Ø®Ø·Ø£ ERR_UNKNOWN_URL_SCHEME
                    const directUrl = `https://t.me/DarkDevil_1111?text=${encodeURIComponent(message)}`;
                    window.location.href = directUrl;
                }
            } catch (error) {
                console.error("Error:", error);
                alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£.. ØªØ£ÙƒØ¯ Ù…Ù† ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø£Ø¯Ù…Ù† Ù„Ù„Ø¨ÙˆØª Ø¨ÙƒÙ„Ù…Ø© Start");
            }
        };
    </script>

    <style>
        body { font-family: 'Cairo', sans-serif; background: #020617; color: white; }
        .glass { background: rgba(30, 41, 59, 0.6); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1); }
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 100; align-items: center; justify-content: center; padding: 20px; }
        .modal.active { display: flex; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body>

    <header class="py-6 text-center border-b border-white/5 bg-slate-900/40 sticky top-0 z-50 backdrop-blur-md">
        <h1 class="text-3xl font-black text-blue-500 italic tracking-tighter">STARS MARKET</h1>
        <p class="text-[10px] tracking-widest text-slate-500 uppercase">Developed by Mohamed Elsayed</p>
    </header>

    <main class="max-w-md mx-auto p-4 mt-4">
        <div class="flex bg-slate-900 p-1.5 rounded-2xl mb-8 border border-white/10 shadow-xl">
            <button onclick="switchMode('buy')" id="btnB" class="flex-1 py-3 rounded-xl font-bold bg-blue-600 shadow-lg shadow-blue-600/20">Ø´Ø±Ø§Ø¡ Ø§Ù„Ù†Ø¬ÙˆÙ…</button>
            <button onclick="switchMode('sell')" id="btnS" class="flex-1 py-3 rounded-xl font-bold text-slate-500 transition-all">Ø¨ÙŠØ¹ Ø§Ù„Ù†Ø¬ÙˆÙ…</button>
        </div>

        <div id="sectionB" class="glass p-6 rounded-[2.5rem] space-y-5 shadow-2xl">
            <h2 class="font-bold border-r-4 border-blue-500 pr-3">Ø´Ø±Ø§Ø¡ (Ø§Ù„Ø­Ø§Ø³Ø¨Ø© 0.8)</h2>
            <div class="space-y-4">
                <input type="number" id="inBStars" oninput="document.getElementById('pB').innerText=(this.value*0.8).toFixed(2)" placeholder="ÙƒÙ… Ù†Ø¬Ù…Ø© ØªØ±ÙŠØ¯ Ø´Ø±Ø§Ø¡Ù‡Ø§ØŸ" class="w-full bg-slate-800/80 p-4 rounded-2xl outline-none border border-white/5 focus:ring-2 focus:ring-blue-500 transition">
                <div class="bg-blue-500/10 p-4 rounded-2xl border border-blue-500/20 flex justify-between items-center">
                    <span class="text-xs text-blue-300">Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ (EGP):</span>
                    <span id="pB" class="text-2xl font-bold text-blue-400">0.00</span>
                </div>
                <input type="text" id="inBUser" placeholder="ÙŠÙˆØ²Ø± Ø§Ù„Ù…Ø³ØªÙ„Ù… (Ù…Ø«Ø§Ù„: @name)" class="w-full bg-slate-800/80 p-4 rounded-2xl outline-none border border-white/5">
                <button onclick="openM('buy')" class="w-full bg-blue-600 hover:bg-blue-500 py-4 rounded-2xl font-bold text-lg shadow-lg shadow-blue-900/40 transition-transform active:scale-95">Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø¯ÙØ¹</button>
            </div>
        </div>

        <div id="sectionS" class="hidden glass p-6 rounded-[2.5rem] space-y-5 shadow-2xl">
            <h2 class="font-bold border-r-4 border-green-500 pr-3 text-green-400">Ø¨ÙŠØ¹ (Ø§Ù„Ø­Ø§Ø³Ø¨Ø© 0.9)</h2>
            <div class="space-y-4">
                <input type="number" id="inSStars" oninput="document.getElementById('pS').innerText=(this.value*0.9).toFixed(2)" placeholder="ÙƒÙ… Ù†Ø¬Ù…Ø© ØªØ±ÙŠØ¯ Ø¨ÙŠØ¹Ù‡Ø§ØŸ" class="w-full bg-slate-800/80 p-4 rounded-2xl outline-none border border-white/5 focus:ring-2 focus:ring-green-500 transition">
                <div class="bg-green-500/10 p-4 rounded-2xl border border-green-500/20 flex justify-between items-center">
                    <span class="text-xs text-green-300">Ø³ØªØ³ØªÙ„Ù… ÙƒØ§Ø´ Ù…Ø¨Ù„Øº:</span>
                    <span id="pS" class="text-2xl font-bold text-green-400">0.00</span>
                </div>
                <input type="text" id="inSUser" placeholder="ÙŠÙˆØ²Ø± Ø­Ø³Ø§Ø¨Ùƒ" class="w-full bg-slate-800/80 p-4 rounded-2xl outline-none border border-white/5">
                <input type="text" id="inSNum" placeholder="Ø±Ù‚Ù… Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ÙƒØ§Ø´" class="w-full bg-slate-800/80 p-4 rounded-2xl outline-none border border-white/5">
                <button onclick="openM('sell')" class="w-full bg-green-600 hover:bg-green-500 py-4 rounded-2xl font-bold text-lg shadow-lg shadow-green-900/40 transition-transform active:scale-95">Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø¢Ù†</button>
            </div>
        </div>
    </main>

    <div id="mB" class="modal">
        <div class="bg-slate-900 p-8 rounded-[2.5rem] w-full max-w-sm border border-blue-500/30">
            <h3 class="text-center font-bold text-xl mb-4">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¯ÙØ¹</h3>
            <p class="text-xs text-slate-400 text-center mb-6">Ù‚Ù… Ø¨ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ø±Ù‚Ù… ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´ Ø§Ù„ØªØ§Ù„ÙŠ</p>
            <div class="p-5 bg-slate-800 rounded-2xl mb-6 text-center border border-blue-500/20">
                <p class="text-[10px] text-blue-400 mb-1 font-bold">VODAFONE CASH</p>
                <p class="text-2xl font-mono font-black tracking-widest">01210931358</p>
            </div>
            <button onclick="finish('buy', 'ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´')" class="w-full py-4 bg-blue-600 rounded-2xl font-bold mb-3 shadow-lg shadow-blue-600/30">ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ØŒ Ø¥Ø±Ø³Ø§Ù„</button>
            <button onclick="closeAll()" class="w-full text-slate-500 py-2 text-sm">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>

    <div id="mS" class="modal">
        <div class="bg-slate-900 p-8 rounded-[2.5rem] w-full max-w-sm border border-green-500/30 text-center">
            <h3 class="font-bold text-xl mb-8">ÙˆØ³ÙŠÙ„Ø© Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ÙƒØ§Ø´</h3>
            <div class="space-y-3">
                <button onclick="finish('sell', 'ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´')" class="w-full p-4 bg-slate-800 rounded-2xl border border-white/5 hover:bg-green-600 transition flex justify-between items-center">ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´ <span class="bg-red-500/20 text-red-500 text-[10px] px-2 py-1 rounded">Voda</span></button>
                <button onclick="finish('sell', 'Ø§Ù†Ø³ØªØ§ Ø¨Ø§ÙŠ')" class="w-full p-4 bg-slate-800 rounded-2xl border border-white/5 hover:bg-green-600 transition flex justify-between items-center">Ø§Ù†Ø³ØªØ§ Ø¨Ø§ÙŠ <span class="bg-pink-500/20 text-pink-500 text-[10px] px-2 py-1 rounded">Insta</span></button>
                <button onclick="finish('sell', 'ÙƒØ±ÙŠØ¨ØªÙˆ')" class="w-full p-4 bg-slate-800 rounded-2xl border border-white/5 hover:bg-green-600 transition flex justify-between items-center">Ù…Ø­ÙØ¸Ø© ÙƒØ±ÙŠØ¨ØªÙˆ <span class="bg-blue-500/20 text-blue-500 text-[10px] px-2 py-1 rounded">TON/USDT</span></button>
            </div>
            <button onclick="closeAll()" class="w-full mt-8 text-slate-500 py-2">Ø±Ø¬ÙˆØ¹</button>
        </div>
    </div>

    <script>
        function switchMode(t) {
            const bB = document.getElementById('btnB'), bS = document.getElementById('btnS');
            const sB = document.getElementById('sectionB'), sS = document.getElementById('sectionS');
            if(t === 'buy') {
                bB.className = "flex-1 py-3 rounded-xl font-bold bg-blue-600 shadow-lg shadow-blue-600/20";
                bS.className = "flex-1 py-3 rounded-xl font-bold text-slate-500";
                sB.classList.remove('hidden'); sS.classList.add('hidden');
            } else {
                bS.className = "flex-1 py-3 rounded-xl font-bold bg-green-600 shadow-lg shadow-green-600/20 text-white";
                bB.className = "flex-1 py-3 rounded-xl font-bold text-slate-500";
                sS.classList.remove('hidden'); sB.classList.add('hidden');
            }
        }

        function openM(t) { document.getElementById(t === 'buy' ? 'mB' : 'mS').classList.add('active'); }
        function closeAll() { document.querySelectorAll('.modal').forEach(m => m.classList.remove('active')); }

        async function finish(type, method) {
            const data = type === 'buy' ? {
                user: document.getElementById('inBUser').value,
                stars: document.getElementById('inBStars').value,
                price: document.getElementById('pB').innerText,
                method: method
            } : {
                user: document.getElementById('inSUser').value,
                stars: document.getElementById('inSStars').value,
                price: document.getElementById('pS').innerText,
                receiveNumber: document.getElementById('inSNum').value,
                method: method
            };

            if(!data.user || !data.stars || (type==='sell' && !data.receiveNumber)) return alert("Ø¨Ø±Ø¬Ø§Ø¡ Ø¥ÙƒÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„");
            closeAll();
            await window.sendAction(type, data);
        }
    </script>
</body>
</html>
